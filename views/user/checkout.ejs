<!DOCTYPE html>
<html lang="en">

<head>
	<title>checkout</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800" rel="stylesheet">

	<link rel="stylesheet" href="/css/open-iconic-bootstrap.min.css">
	<link rel="stylesheet" href="/css/animate.css">

	<link rel="stylesheet" href="/css/owl.carousel.min.css">
	<link rel="stylesheet" href="/css/owl.theme.default.min.css">
	<link rel="stylesheet" href="css/magnific-popup.css">

	<link rel="stylesheet" href="/css/aos.css">

	<link rel="stylesheet" href="/css/ionicons.min.css">

	<link rel="stylesheet" href="/css/bootstrap-datepicker.css">
	<!-- <link rel="stylesheet" href="/css/"> -->


	<link rel="stylesheet" href="/css/flaticon.css">
	<link rel="stylesheet" href="/css/icomoon.css">
	<link rel="stylesheet" href="/css/style.css">



</head>

<body class="goto-here">

	<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
		<div class="container">
			<a class="navbar-brand" href="index.html">Minishop</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav"
				aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
				<span class="oi oi-menu"></span> Menu
			</button>

			<div class="collapse navbar-collapse" id="ftco-nav">
				<ul class="navbar-nav ml-auto">
					<li class="nav-item active"><a href="/" class="nav-link">Home</a></li>
					<li class="nav-item dropdown">
						<a class="nav-link dropdown-toggle" href="#" id="dropdown04" data-toggle="dropdown"
							aria-haspopup="true" aria-expanded="false">Catalog</a>
						<div class="dropdown-menu" aria-labelledby="dropdown04">
							<a class="dropdown-item" href="/shop">Shop</a>
							<a class="dropdown-item" href="/cart">Cart</a>

						</div>
					</li>
					<li class="nav-item"><a href="/about" class="nav-link">About</a></li>
					<li class="nav-item"><a href="/blog" class="nav-link">Blog</a></li>
					<li class="nav-item"><a href="/contact" class="nav-link">Contact</a></li>
					<li class="nav-item cta cta-colored"><a href="/cart" class="nav-link"><span
								class="icon-shopping_cart"></span></a></li>

				</ul>
			</div>
		</div>
	</nav>
	<!-- END nav -->

	<div class="hero-wrap hero-bread" style="background-image: url('/images/about-heading.webp');">
		<div class="container">
			<div class="row no-gutters slider-text align-items-center justify-content-center">
				<div class="col-md-9 ftco-animate text-center">
					<p class="breadcrumbs"><span class="mr-2"><a href="index.html">Home</a></span> <span>Checkout</span>
					</p>
					<h1 class="mb-0 bread">Checkout</h1>
				</div>
			</div>
		</div>
	</div>




	<section class="ftco-section">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-xl-10 ftco-animate">


					<form action="" class="billing-form" id="myForm" onsubmit="validateForm()">
						<h3 class="mb-4 billing-heading">Billing Details</h3>



						<%if (address && address.address && address.address.length>0 ){%>
							<section id="edit-address-div">

								<div class="row ">
									<% address.address.forEach(function (address,index) { %>
										<%console.log(address._id,'asdfghjk')%>
											<div class="addressdiv col-lg-5 pb-4 mt-4 justify-content-between mr-4 ">
												<input type="radio" id="selectedAddress" name="selectedAddress"
													value="<%= address._id %>" <% if (index===0) { %>checked<% } %>
													required>
													<h5 class="edit-add-head">
														address<%=index+1%>
													</h5>
													<p>
														name :
														<%= address.fullname %>
													</p>
													<p>
														Mobile :
														<%= address.mobile %>
													</p>
													<p>
														email :
														<%= address.email %>
													</p>
													<p>
														State :
														<%= address.state %>
													</p>
													<p>
														City :
														<%= address.city %>
													</p>
													<p>
														House name :
														<%= address.houseName %>
													</p>
													<p>
														pin :
														<%= address.pin %>
													</p>
													<div class="pt-2">
														<button type="button"
															class="btn btn-primary edit-btn pt-2 edit-btn-add "
															onclick="checkouteditaddressopenmodal('<%= address.fullname %>','<%= address.mobile %>',' <%= address.email %>',' <%= address.state %>','<%= address.city %>','<%= address.houseName %>','<%= address.pin %>','<%= address._id %>')">
															<i class="text-muted material-icons md-post_add"></i>
															Edit
														</button>

													</div>
											</div>


											<% }) %>
								</div>
							</section>



							<%}else{%>

								<div class="card-body pb-2 d-flex justify-content-center">

									<div class=" pb-4 me-1">
										<p>you have no address</p>

										<button type="button" class="btn btn-primary edit-btn ml-4"
											onclick=" addressopenmodal()">
											<i class="text-muted material-icons md-post_add "></i>add
											address
										</button>
									</div>
								</div>
								<%}%>
									<section>
										<div class=" mt-5">

											<a type="button" class="addaddressbutton" onclick=" addressopenmodal()">
												add
												address
											</a>

											<a type="button" id="showHideButton" class="applycoupon"
												style="color: rgb(255, 255, 255);">
												Apply Coupon
											</a>


											<!-- <div class="card-section mt-5" id="cardSection">
												<div class="row" id="relodedives">
													<% for (let i=0; i < coupon.length; i++) { %>
														<div class="col-lg-6 pb-2">
															<div class="card coupon-card">
																<div class="card-body">
																	<h5 class="card-title">
																		<%= coupon[i].name %>
																	</h5>
																	<h6 class="card-subtitle mb-2 text-muted">
																		<%= coupon[i].discountPercentage %> OFF
																	</h6>
																	<p class="card-text">
																		Coupon Code: <%= coupon[i].couponCode %>
																	</p>
																	<p class="card-text">
																		Validity Period: <%= coupon[i].expiryDate.toLocaleDateString('en-US', { weekday: 'short' , year: 'numeric' , month: 'short' , day: 'numeric' }) %>
																	</p>
																	<% if(subtotel > coupon[i].criteriaValue) { %>
																		<% if (!cartData.couponDiscount || coupon[i]._id.toString() !== cartData.couponDiscount._id.toString()) { %>
																			<button class="btn btn-primary" onclick="couponapply('<%= coupon[i]._id %>')">Use It</button>
																		<% } else { %>
																			<button class="btn btn-secondary" onclick="removecoupon('<%= coupon[i]._id %>')">Remove</button>
																		<% } %>
																	<% } else { %>
																		<span class="badge badge-danger">Not Applicable</span>
																	<% } %>
																</div>
															</div>
														</div>
													<% } %>
												</div>
											</div> -->



											<div class="card-section mt-5" id="cardSection">
												<div class="" id="relodedives">

													<% for (let i=0; i < coupon.length; i++) { %>
														<div class="col-lg-6 pb-2">
															<div
																class="cart-detail cart-total bg-light p-md-4  couponcard">
																<p class="offer-t">
																	<%= coupon[i].discountPercentage %> %OFF
																</p>
																<p class="coupon-name">
																	<%= coupon[i].name %>
																</p>
																<p class="coupon-code">
																	<a class="">
																		<%= coupon[i].couponCode %>
																	</a>
																</p>
																<p class="mb-0 couun-date">
																	Validity Period :
																	<%= coupon[i].expiryDate.toLocaleDateString('en-US',
																		{ weekday: 'short' , year: 'numeric' ,
																		month: 'short' , day: 'numeric' }) %>


																		<% if(subtotel>coupon[i].criteriaValue) {%>

																			<% if (coupon[i]._id.toString()
																				!==(cartData.couponDiscount ?
																				cartData.couponDiscount._id.toString() :
																				null)) { %>

																				<a class="coupon-button"
																					onclick="couponapply('<%= coupon[i]._id %>')">Use
																					It</a>
																				<% } else if (cartData.couponDiscount &&
																					coupon[i]._id.toString()===(cartData.couponDiscount._id
																					?
																					cartData.couponDiscount._id.toString()
																					: null)) { %>
																					<a class="coupon-button removebtn"
																						onclick="removecoupon('<%= coupon[i]._id %>')">Remove</a>
																					<% } %>

																						<%}else{%>
																							<span
																								class="badge not-applicable">Not
																								Applicable</span>
																							<%}%>
																</p>
															</div>
														</div>
														<% } %>
												</div>
											</div>

										</div>
									</section>

									<!-- END -->



									<div class="row mt-5 pt-3 d-flex" id="checkrelodedives">
										<div class="col-md-6 d-flex">
											<div class="cart-detail cart-total bg-light p-3 p-md-4">
												<h3 class="billing-heading mb-4">Cart Total</h3>
												<p class="d-flex">
													<span>Subtotal</span>
													<span>
														₹ <%=subtotel%>
													</span>
												</p>
												<p class="d-flex">
													<span>Delivery</span>
													<span>₹ 0.00</span>
												</p>
												<p class="d-flex">
													<span>Discount</span>
													<span>
														<%=coupondiscount%> %
													</span>
												</p>
												<hr>

												<p class="d-flex">
													<span>Original Amount: </span>
													<span>
														<% if (discountamount !==subtotel ) { %>
															<del>
																₹<%= subtotel %>
															</del>
															<br>

													</span>
												</p>

												<p class="d-flex">

													<span>Discounted Amount:</span>
													<span>
														₹<%= discountamount %>
															<% } else { %>
																₹<%= subtotel %>
																	<% } %>
													</span>



												</p>





											</div>

										</div>
										<div class="col-md-6">
											<div class="cart-detail bg-light p-3 p-md-4">
												<h3 class="billing-heading mb-4">Payment Method</h3>
												<p class="" id="inputid"
													style="display: none; color: rgb(255, 93, 93);">Please select a
													payment methode</p>
												<div class="form-group">
													<div class="col-md-12">


														<div class="radio">
															<% if (subtotel > 1500) { %>

																<label class="m-0">

																	<input type="radio" name="payment" value="Cash on delivery" id="radio1" disabled>
																	Cash on Delivery

																	<p style="font-size: 13px; color: rgb(255, 165, 165);" class="">Cash on Delivery is not available </br> for orders over 1500.</p>

																</label>
															<% } else { %>
																<label>
																	<input type="radio" name="payment" value="Cash on delivery" id="radio1">
																	Cash on Delivery
																</label>
															<% } %>
															
															
														</div>
													</div>
												</div>
												<div class="form-group">
													<div class="col-md-12">
														<div class="radio">
															<label> <input type="radio" name="payment" value="Razorpay"
																	id="radio2" />
																Razorpay
															</label>
														</div>
													</div>
												</div>

												<div class="form-group">
													<div class="col-md-12">
														<div class="radio">
															<label>
																<input type="radio" name="payment" value="Wallet"
																	id="radio3" <%=userData.wallet> subtotel ? '' :
																'disabled' %> />
																wallet

															</label>
															<p style="float: right;">Wallet Balance: <%= userData.wallet
																	%>
															</p>

														</div>

													</div>

												</div>
												<div class="form-group">
													<div class="col-md-12">
														<div class="checkbox">
															<label><input type="checkbox" value="" class="mr-2" /> I
																have
																read and accept
																the terms and conditions</label>
														</div>
													</div>
												</div>
												<p><a onclick="validateForm(event)"
														class="btn btn-primary py-3 px-4">Place an order</a></p>
											</div>
										</div>
									</div>
					</form>
				</div> <!-- .col-md-8 -->
			</div>
		</div>
	</section> <!-- .section -->



	<footer class="ftco-footer ftco-section">
		<div class="container">
			<div class="row">
				<div class="mouse">
					<a href="#" class="mouse-icon">
						<div class="mouse-wheel"><span class="ion-ios-arrow-up"></span></div>
					</a>
				</div>
			</div>
			<div class="row mb-5">
				<div class="col-md">
					<div class="ftco-footer-widget mb-4">
						<h2 class="ftco-heading-2">Minishop</h2>
						<p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia.</p>
						<ul class="ftco-footer-social list-unstyled float-md-left float-lft mt-5">
							<li class="ftco-animate"><a href="#"><span class="icon-twitter"></span></a></li>
							<li class="ftco-animate"><a href="#"><span class="icon-facebook"></span></a></li>
							<li class="ftco-animate"><a href="#"><span class="icon-instagram"></span></a></li>
						</ul>
					</div>
				</div>
				<div class="col-md">
					<div class="ftco-footer-widget mb-4 ml-md-5">
						<h2 class="ftco-heading-2">Menu</h2>
						<ul class="list-unstyled">
							<li><a href="#" class="py-2 d-block">Shop</a></li>
							<li><a href="#" class="py-2 d-block">About</a></li>
							<li><a href="#" class="py-2 d-block">Journal</a></li>
							<li><a href="#" class="py-2 d-block">Contact Us</a></li>
						</ul>
					</div>
				</div>
				<div class="col-md-4">
					<div class="ftco-footer-widget mb-4">
						<h2 class="ftco-heading-2">Help</h2>
						<div class="d-flex">
							<ul class="list-unstyled mr-l-5 pr-l-3 mr-4">
								<li><a href="#" class="py-2 d-block">Shipping Information</a></li>
								<li><a href="#" class="py-2 d-block">Returns &amp; Exchange</a></li>
								<li><a href="#" class="py-2 d-block">Terms &amp; Conditions</a></li>
								<li><a href="#" class="py-2 d-block">Privacy Policy</a></li>
							</ul>
							<ul class="list-unstyled">
								<li><a href="#" class="py-2 d-block">FAQs</a></li>
								<li><a href="#" class="py-2 d-block">Contact</a></li>
							</ul>
						</div>
					</div>
				</div>
				<div class="col-md">
					<div class="ftco-footer-widget mb-4">
						<h2 class="ftco-heading-2">Have a Questions?</h2>
						<div class="block-23 mb-3">
							<ul>
								<li><span class="icon icon-map-marker"></span><span class="text">203 Fake St. Mountain
										View, San Francisco, California, USA</span></li>
								<li><a href="#"><span class="icon icon-phone"></span><span class="text">+2 392 3929
											210</span></a></li>
								<li><a href="#"><span class="icon icon-envelope"></span><span
											class="text">info@yourdomain.com</span></a></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12 text-center">

					<p><!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
						Copyright &copy;
						<script>document.write(new Date().getFullYear());</script> All rights reserved | This template
						is made with <i class="icon-heart color-danger" aria-hidden="true"></i> by <a
							href="https://colorlib.com" target="_blank">Colorlib</a>
						<!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
					</p>
				</div>
			</div>
		</div>
	</footer>





	<!-- loader -->
	<div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
			<circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
			<circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
				stroke="#F96D00" />
		</svg>
	</div>




	<section>
		<div id="checkoutEditAddressmodal" class="modal" id="editmodal">
			<div class="modal-content  address-modal  w-50">
				<form>
					<span class="close" onclick="checkouteditaddressclosemodal()">&times;</span>


					<div class="form-group m-0">
						<label class="form-label">Full Name *</label>
						<input type="text" id="editfullname" class="form-control" name="editfullname">
						<span id="edit-fullname-error" style="color: red;"></span>
					</div>
					<div class="row">
						<div class="col-lg-6">
							<div class="form-group m-0">
								<label class="form-label">Email *</label>
								<input type="email" id="editemail" class="form-control" name="editemail">
								<span id="edit-email-error" style="color: red;"></span>
							</div>
							<div class="form-group m-0">
								<label class="form-label">State *</label>
								<input type="text" id="editstate" class="form-control" name="editstate">
								<span id="edit-state-error" style="color: red;"></span>

							</div>
							<div class="form-group m-0">
								<label class="form-label">Pincode *</label>
								<input type="text" id="editpin" class="form-control" name="editpin">
								<span id="edit-pin-error" style="color: red;"></span>

							</div>
						</div>
						<div class="col-lg-6">
							<div class="form-group m-0">
								<label class="form-label">Mobile *</label>
								<input type="text" id="editmobile" class="form-control" name="editmobile">
								<span id="edit-mobile-error" style="color: red;"></span>

							</div>
							<div class="form-group m-0">
								<label class="form-label">City *</label>
								<input type="text" id="editcity" class="form-control" name="editcity">
								<span id="edit-city-error" style="color: red;"></span>
							</div>
							<div class="form-group m-0">
								<label class="form-label">House name *</label>
								<input type="text" id="edithousename" class="form-control" name="edithousename">
								<span id="edit-houseName-error" style="color: red;"></span>

							</div>

							<!-- Add hidden input for address ID -->
							<input type="hidden" name="editAddressId" id="editAddressId" />

						</div>
						<div class="pt-2 me-1 d-flex justify-content-center w-100">
							<button class="btn btn-primary edit-btn" id="EditAddressButtons">
								<i class="text-muted material-icons md-post_add"></i>Save Address
							</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</section>

	<section>
		<div id="checkaddaddressmodal" class="modal ">
			<div class="modal-content  address-modal  w-50 ">
				<form>
					<span class="close" onclick=" addressclosemodal()">&times;</span>
					<div class="form-group ">
						<label class="form-label"> Full name *</label>
						<input type="text" id="fullname" class="form-control" name="fullname">
						<span id="fullname-error" style="color: red;"></span>

					</div>
					<div class="row">
						<div class="col-lg-6  ">
							<div class="form-group ">
								<label class="form-label">Email *</label>
								<input type="text" id="email" class="form-control" name="email">
								<span id="email-error" style="color: red;"></span>
							</div>
							<div class="form-group ">
								<label class="form-label">State *</label>
								<input type="text" id="state" class="form-control" name="state">
								<span id="state-error" style="color: red;"></span>

							</div>
							<div class="form-group ">
								<label class="form-label">Pincode *</label>
								<input type="text" id="pin" class="form-control" name="pin">
								<span id="pin-error" style="color: red;"></span>

							</div>
						</div>
						<div class="col-lg-6">
							<div class="form-group ">
								<label class="form-label">Mobile *</label>
								<input type="text" id="mobile" class="form-control" name="mobile">
								<span id="mobile-error" style="color: red;"></span>

							</div>
							<div class="form-group  ">
								<label class="form-label">City *</label>
								<input type="text" id="city" class="form-control" name="city">
								<span id="city-error" style="color: red;"></span>
							</div>
							<div class="form-group  ">
								<label class="form-label">House name *</label>
								<input type="text" id="housename" class="form-control" name="housename">
								<span id="houseName-error" style="color: red;"></span>

							</div>
						</div>
						<div class="pt-1 me-1 d-flex justify-content-center w-100">
							<button class="btn btn-primary edit-btn justify-content-center" id="addAddressButton">
								<i class="text-muted material-icons md-post_add"></i>Save Address
							</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</section>



	<script>

		function checkouteditaddressopenmodal(fullname, mobile, email, state, city, houseName, pin, addressId) {
			

			document.querySelector('[name="editfullname"]').value = fullname;
			document.querySelector('[name="editmobile"]').value = mobile;
			document.querySelector('[name="editemail"]').value = email;

			document.querySelector('[name="editstate"]').value = state;
			document.querySelector('[name="editcity"]').value = city;
			document.querySelector('[name="edithousename"]').value = houseName;
			document.querySelector('[name="editpin"]').value = pin;

			document.getElementById('editAddressId').value = addressId;

			document.getElementById("checkoutEditAddressmodal").style.display = "block";
			document.getElementById("checkoutEditAddressmodal").style.overflow = "hidden";


		}
		function checkouteditaddressclosemodal() {
			
			document.getElementById('checkoutEditAddressmodal').style.display = "none";
		}
		// edit address validation 

		document.addEventListener('DOMContentLoaded', function () {
			document.getElementById("EditAddressButtons").addEventListener('click', function (event) {
				event.preventDefault();
				checkouteditaddressvalidation();
			});
		})


		// add addres modal

		function addressopenmodal() {
			document.getElementById("checkaddaddressmodal").style.display = "block";
			document.getElementById("checkaddaddressmodal").style.overflow = "hidden";

		}
		function addressclosemodal() {
			document.getElementById('checkaddaddressmodal').style.display = "none";
		}

		// add address validation 

		document.addEventListener('DOMContentLoaded', function () {
			document.getElementById("addAddressButton").addEventListener('click', function (event) {
				event.preventDefault();
				checkoutaddressvalidation();
			});
		})


		// card hidden script
		document.getElementById('showHideButton').addEventListener('click', function () {
			event.preventDefault();
			let cardSection = document.getElementById('cardSection');
			if (cardSection.style.display === 'none') {
				cardSection.style.display = 'block';
			} else {
				cardSection.style.display = 'none';
			}
		});


	</script>


	<!-- swal -->

	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


	<script src="/assets/js/vendors/jquery-3.6.0.min.js"></script>
	<script src="/assets/js/vendors/bootstrap.bundle.min.js"></script>

	<script src="js/jquery.min.js"></script>
	<script src="js/jquery-migrate-3.0.1.min.js"></script>
	<script src="js/popper.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/jquery.easing.1.3.js"></script>
	<script src="js/jquery.waypoints.min.js"></script>
	<script src="js/jquery.stellar.min.js"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/aos.js"></script>
	<script src="js/jquery.animateNumber.min.js"></script>
	<script src="js/bootstrap-datepicker.js"></script>
	<script src="js/scrollax.min.js"></script>
	<script
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
	<script src="js/google-map.js"></script>
	<script src="js/main.js"></script>



	<script>
		$(document).ready(function () {

			var quantitiy = 0;
			$('.quantity-right-plus').click(function (e) {

				// Stop acting like a button
				e.preventDefault();
				// Get the field name
				var quantity = parseInt($('#quantity').val());

				// If is not undefined

				$('#quantity').val(quantity + 1);


				// Increment

			});

			$('.quantity-left-minus').click(function (e) {
				// Stop acting like a button
				e.preventDefault();
				// Get the field name
				var quantity = parseInt($('#quantity').val());

				// If is not undefined

				// Increment
				if (quantity > 0) {
					$('#quantity').val(quantity - 1);
				}
			});

		});
	</script>

	<!-- razerpay -->
	<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

	<!-- address adding fetch linked -->
	<script src="/js/fetch.js"></script>
	<!-- swal -->
	<!-- Latest version of jQuery -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

	<script src="https://code.jquery.com/jquery-3.7.1.js"
		integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>


</body>

</html>